{% extends "layout.html" %}
{% set title = "Contexts" %}
{% block body %}
<script>
  {% coffee "contextlist" %}
  $ ->
    dtable = yamoda.utils.setup_datatable($("#contexttable"))
    yamoda.utils.setup_column_filter_boxes($("#contexttable th.footer input.filter-input"), dtable)
    $("#contexttable_wrapper .datatables-top-left-bar").append($("#new_context_action").remove())
  {% endcoffee %}
</script>
  <h2>Data contexts</h2>
  <div id="new_context_action"><a class="btn" data-toggle="modal" href="#new_context">New Context</a></div>
  <table id="contexttable" class="table table-condensed table-bordered table-striped">
    <thead>
      <tr>
        <th>Context</th>
        <th>Brief description</th>
    </tr>
    </thead>
    <tbody>
      {%- for context in contextlist %}
      <tr>
        <td><a href="{{ url_for('context', context_name=context.name) }}">{{ context.name }}</a></td>
        <td>{{ context.brief }}</td>
      </tr>
      {%- endfor %}
    </tbody>
  </table>
  <div class="modal hide" id="new_context">
    <form class="modal-form" action="{{ url_for('create_context') }}" method="post">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">×</button>
        <h3>New Context</h3>
      </div>
      <div class="modal-body">
        <label>Name</label>
        <input type="text" class="span3" placeholder="Context name…" name="context_name">
        <label>Brief</label>
        <input type="text" class="span12" placeholder="A brief description…" name="context_brief">
        <label>Description</label>
        <textarea class="span12" name="context_description"
                  placeholder="A full description (in Markdown syntax)…"></textarea>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn" data-dismiss="modal">Cancel</button>
        <button type="submit" class="btn btn-primary">
          <i class="icon-ok-sign icon-white"></i> Create
        </button>
      </div>
    </form>
  </div>
{% endblock %}

{# vim: set filetype=htmljinja sw=2 ts=2 sts=2 expandtab: #}
